# 부품비 계산 공식 및 검증

## #1. 부품비1 (일반관리비 + 이윤 방식)

### 입력값
- 자재비: 88,500원 (사용자 입력)
- 인건비: 480,000원 (사용자 입력)
- 장비대: 65,000원 (사용자 입력)
- 일반관리비율: 6% (사용자 입력, 기본값 6%)
- 이윤: 58,301원 (사용자 입력, "10%"는 참고 정보)

### 계산 과정

#### 1단계: 소계 계산
```
소계 = 자재비 + 인건비 + 장비대
     = 88,500 + 480,000 + 65,000
     = 633,500원
```

#### 2단계: 일반관리비 계산
```
일반관리비 = 소계 × 일반관리비율
          = 633,500 × 6%
          = 633,500 × 0.06
          = 38,010원
```

#### 3단계: 공사원가 계산
```
공사원가 = 소계 + 일반관리비
        = 633,500 + 38,010
        = 671,510원
```

#### 4단계: 이윤 입력
```
이윤 = 58,301원 (사용자 입력값)

※ "이윤(10%)"는 참고 정보이며, 실제 계산에 사용되는 값은 사용자가 직접 입력
```

#### 5단계: 공급가액 계산 (VAT 제외)
```
공급가액(계산) = 소계 + 일반관리비 + 이윤
              = 633,500 + 38,010 + 58,301
              = 729,811원

총액(VAT포함, 계산) = 729,811 × 1.1 = 802,792원
총액(절사 적용) = 800,000원 (1000원 단위 절하)

최종 공급가액 = 800,000 / 1.1 = 727,272원 (VAT 역산)
```

#### 6단계: VAT 계산
```
VAT = 공급가액 × 10%
    = 727,272 × 0.10
    = 72,727.2
    = 72,728원 (원 단위 반올림)

또는:
VAT = 총액 - 공급가액
    = 800,000 - 727,272
    = 72,728원
```

#### 7단계: 총액 계산
```
총액 = 공급가액 + VAT
     = 727,272 + 72,728
     = 800,000원
```

### 결과 검증
- ✓ 소계: 633,500원 (88,500 + 480,000 + 65,000)
- ✓ 일반관리비: 38,010원 (633,500 × 6%)
- ✓ 공사원가: 671,510원 (633,500 + 38,010)
- ✓ 이윤: 58,301원 (사용자 입력)
- ✓ 공급가액(계산): 729,811원 (633,500 + 38,010 + 58,301)
- ✓ 총액(계산): 802,792원 (729,811 × 1.1)
- ✓ 총액(절사): 800,000원 (1000원 단위 절하)
- ✓ 공급가액(최종): 727,272원 (800,000 / 1.1, 역산)
- ✓ VAT: 72,728원 (800,000 - 727,272)

**계산 흐름:**
공급가액 729,811원 → VAT 포함 802,792원 → 1000원 절사 800,000원 → VAT 역산 727,272원

---

## #2. 부품비2 (합산 + 할인 방식)

### 입력값
- 탈착교환: 2,288,000원
- 판금수리: 78,000원
- 도장: 250,000원
- 부품: 2,363,600원
- 할인율: 5%

### 계산 과정

#### 1단계: 부품 할인 적용
```
부품 할인금액 = 부품 × (1 - 할인율)
             = 2,363,600 × (1 - 0.05)
             = 2,363,600 × 0.95
             = 2,245,420원

할인액 = 2,363,600 - 2,245,420 = 118,180원
```

#### 2단계: 합계 계산
```
합계 = 탈착교환 + 판금수리 + 도장 + 부품(할인후)
     = 2,288,000 + 78,000 + 250,000 + 2,245,420
     = 4,861,420원
```

#### 3단계: 절사/반올림 적용
```
결과금액 = 4,861,420원 → 4,970,000원

절상금액 = 4,970,000 - 4,861,420
        = 108,580원

(참고: "↑9,600원"의 정확한 의미는 추가 확인 필요)
```

### 결과 검증
- ✓ 탈착교환: 2,288,000원
- ✓ 판금수리: 78,000원
- ✓ 도장: 250,000원
- ✓ 부품 (5% 할인 전): 2,363,600원
- ✓ 부품 (5% 할인 후): 2,245,420원
- ✓ 합계 (할인 적용): 4,861,420원
- ✓ 결과금액 (조정 후): 4,970,000원
- ⚠ 조정금액: 108,580원 (↑9,600원과 불일치, 추가 확인 필요)
- ℹ VAT: 별도 계산

---

## 계산 공식 요약

### 부품비1 공식
```javascript
// 입력값 (5개)
자재비 = input         // 예: 88,500
인건비 = input         // 예: 480,000
장비대 = input         // 예: 65,000
일반관리비율 = input   // 예: 6 (%, 기본값 6)
이윤 = input           // 예: 58,301

// 계산 과정
소계 = 자재비 + 인건비 + 장비대
일반관리비 = 소계 × (일반관리비율 / 100)
공사원가 = 소계 + 일반관리비

공급가액_계산 = 소계 + 일반관리비 + 이윤
총액_계산 = 공급가액_계산 × 1.1
총액_절사 = Math.floor(총액_계산 / 1000) × 1000  // 1000원 절하

// 최종 결과 (VAT 역산)
공급가액_최종 = Math.floor(총액_절사 / 1.1)
VAT = 총액_절사 - 공급가액_최종
```

### 부품비2 공식
```javascript
부품_할인후 = 부품 × (1 - 할인율)
합계 = 탈착교환 + 판금수리 + 도장 + 부품_할인후
결과금액 = 합계 (조정 로직 추가 확인 필요)
// VAT는 별도 계산
```

---

## 참고 사항

1. **부품비1의 이윤**:
   - 이윤은 사용자가 직접 입력하는 값
   - "이윤(10%)"는 참고 정보일 뿐, 계산 공식이 아님
   - 총액 계산 후 1000원 단위 절사 적용

2. **부품비2의 조정금액**:
   - "↑9,600원"의 의미가 불명확
   - 10,000원 단위 절상/반올림 로직 확인 필요

3. **VAT 계산**:
   - 부품비1: VAT 포함 총액에서 역산
   - 부품비2: VAT 별도 표시
